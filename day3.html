<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script type="module">
        const lines = await fetch('txt/day3.txt').then(response => response.text());

        let suma = 0;
        for (const line of lines.split('\n')) {
            suma += findLargest(line);
        }

        // console.log(sum);
        

        function findLargest(line) {
            line = line.trim();

            const dict = {
                0: [],
                1: [],
                2: [],
                3: [],
                4: [],
                5: [],
                6: [],
                7: [],
                8: [],
                9: []
            }

            // fill the dict
            let i = 0;
            for (const range of line.split('')) dict[range].push(i++);
            

            // concat all arrays reversely
            let concated = [];
            for (let j = 9; j >= 0; j--) concated = concated.concat(dict[j]);
            
            
            const batteries = 12; //part one is 2

            let sum = 0;
            // min index to choose
            let minIdx = 0;

            for (let b = 0; b < batteries; b++) {
                // max index to choose
                const maxIdx = line.length - batteries + b;
                
                let selectedIdx = concated[0]
                let x = 0;
                
                while(concated[x] < minIdx || concated[x] > maxIdx) {
                    x++;
                    // console.log("conc: ", x, line[concated[x]], concated[x], concated[x] <= minIdx , concated[x] > maxIdx);
                }
                selectedIdx = concated[x];
                
                minIdx = selectedIdx + 1;


                sum = sum * 10 + parseInt(line[selectedIdx]);
            }
            
            return sum;
        }

        console.log(suma);
        
    </script>
</body>
</html>